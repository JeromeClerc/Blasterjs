$(document).ready(function(){function e(){for(var r=1;17>r;r++)if(13>r&&0!==parseInt(Grid[r])){var n=r+4;if(a(n)){o(r,n,Grid[r]);var i=!0}else if(parseInt(Grid[r])===parseInt(Grid[n])){d(r,n,Grid[r]);var i=!0}}return i?(e(),void 0):!1}function r(){for(var e=1;17>e;e++)if(e>4&&0!==parseInt(Grid[e])){var n=e-4;if(a(n)){o(e,n,Grid[e]);var i=!0}else if(parseInt(Grid[e])===parseInt(Grid[n])){d(e,n,Grid[e]);var i=!0}}return i?(r(),void 0):!1}function n(){for(var e=1;17>e;e++)if(1===parseInt(e)||5===parseInt(e)||9===parseInt(e)||13===parseInt(e))console.log("Already to the left side");else if(0!==parseInt(Grid[e])){var r=e-1;if(a(r)){o(e,r,Grid[e]);var i=!0}else if(parseInt(Grid[e])===parseInt(Grid[r])){d(e,r,Grid[e]);var i=!0}}return i?(n(),void 0):!1}function i(){for(var e=1;17>e;e++)if(4===parseInt(e)||8===parseInt(e)||12===parseInt(e)||16===parseInt(e))console.log("Already to the right side");else if(0!==parseInt(Grid[e])){var r=e+1;if(a(r)){o(e,r,Grid[e]);var n=!0}else if(parseInt(Grid[e])===parseInt(Grid[r])){d(e,r,Grid[e]);var n=!0}}return n?(i(),void 0):!1}function t(){for(var e=!0,r=1;17>r;r++)0===Grid[r]&&(e=!1);return e}function a(e){var r=!1;return 17>e&&0===Grid[e]?!0:r}function o(e,r,n){Grid[e]=0,Grid[r]=n}function d(e,r,n){Grid[e]=parseInt(0),Grid[r]=parseInt(n)+parseInt(n),s(n),E()}function s(e){var r=10*e;Score+=r,$("#score").empty().append(Score),2048===parseInt(e)&&c(!0)}function p(){Moves+=1,$("#moves").empty().append(Moves)}function f(){u(),v(),l(),G(),I(),m(),y(2),$(".end-game").hide()}function c(e){Game=!1,e===!0?$(".end-game").empty().append("YOU WIN !!!").show():$(".end-game").empty().append("YOU LOOSE :'(").show()}function l(){TilesClass={2:"one",4:"two",8:"three",16:"four",32:"five",64:"six",128:"seven",256:"eight",512:"nine",1024:"ten",2048:"eleven"}}function u(){Grid={1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0}}function v(){Merging={1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,14:!0,15:!0,16:!0}}function G(){Score=0,$("#score").empty().append(Score)}function I(){Moves=0,$("#moves").empty().append(Moves)}function m(){Game=!0}function y(e){for(var r=0;e>r;r++){var n=Math.floor(16*Math.random()+1),i=Math.floor(100*Math.random()+1);0!==Grid[n]?y(e):Grid[n]=g(i)}E()}function h(){var e=Math.floor(16*Math.random()+1),r=Math.floor(100*Math.random()+1);0!==Grid[e]?h():Grid[e]=g(r),E()}function g(e){if(90>e)var r=2;else var r=4;return r}function E(){Y();for(var e=1;17>e;e++)0!==Grid[e]&&$("#tile-"+e).addClass(TilesClass[Grid[e]]).empty().append(Grid[e])}function Y(){$("#grid-wrapper").empty().append('<ul class="small-block-grid-4">');for(var e=1;17>e;e++)$(".small-block-grid-4").append('<li><div class="tile" id="tile-'+e+'">&nbsp;</div></li>');$("#grid-wrapper").append("</ul>")}KEY_DOWN=40,KEY_UP=38,KEY_LEFT=37,KEY_RIGHT=39,f(),$("body").on("click","a.button",function(){"new-game"===$(this).attr("role")&&f()}),$(document).on("keyup",function(a){Game&&(a.keyCode===KEY_LEFT&&(n()?h():t()?c(!1):h()),a.keyCode===KEY_RIGHT&&(i()?h():t()?c(!1):h()),a.keyCode===KEY_UP&&(r()?h():t()?c(!1):h()),a.keyCode===KEY_DOWN&&(e()?h():t()?c(!1):h()),(a.keyCode===KEY_LEFT||a.keyCode===KEY_DOWN||a.keyCode===KEY_UP||a.keyCode===KEY_RIGHT)&&p())}),$("#grid-wrapper").swipe({swipe:function(a,o){Game&&("left"===o&&(n()?h():t()?c(!1):h()),"right"===o&&(i()?h():t()?c(!1):h()),"up"===o&&(r()?h():t()?c(!1):h()),"down"===o&&(e()?h():t()?c(!1):h()),("left"===o||"right"===o||"up"===o||"down"===o)&&p())}})});